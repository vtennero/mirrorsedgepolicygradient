# Time Scale Debug Guide

## Debug ID System

When you run inference, you'll get a unique **DEBUG-ID** (8-character code like `A1B2C3D4`). Use this to filter logs:

**Python script logs:** `[DEBUG-XXXX]`  
**Unity runtime logs:** `[TIMESCALE-DEBUG-XXXX]`

## All Places Where Time Scale Can Be Set

### 1. ✅ Python Script (`src/run_inference.py`)
- **Location:** Command line argument `--time-scale`
- **Default:** 1.0
- **Debug:** Look for `[DEBUG-XXXX] Command line time_scale argument: X`

### 2. ✅ Temp Config File (Generated by script)
- **Location:** Temporary YAML file in system temp directory
- **Set by:** Script writes `engine_settings.time_scale` to temp config
- **Debug:** Look for `[DEBUG-XXXX] Verified time_scale in temp config: X`
- **Check:** Script prints full `engine_settings` section

### 3. ✅ Unity Project Settings (`src/ProjectSettings/TimeManager.asset`)
- **Location:** Line 13: `m_TimeScale: 1`
- **Current value:** 1 (already fixed)
- **Debug:** Script checks and prints this value
- **Note:** This is Unity's default, but ML-Agents should override it

### 4. ⚠️ ML-Agents Runtime Application
- **Location:** ML-Agents applies `time_scale` from config when connecting to Unity
- **When:** During environment initialization
- **Debug:** Unity logs show actual `Time.timeScale` at runtime
- **Issue:** ML-Agents might not be applying it correctly

### 5. ⚠️ Unity Editor Play Mode
- **Location:** Unity Editor might override time scale in Play mode
- **Check:** Unity Console logs with `[TIMESCALE-DEBUG-XXXX]`

## How to Debug

### Step 1: Run Inference
```bash
cd src
python run_inference.py --time-scale=0.00001
```

### Step 2: Note the DEBUG-ID
Look for: `[DEBUG-XXXX] Debug ID: XXXX`

### Step 3: Check Python Logs
Filter for: `[DEBUG-XXXX]`
- Verify command line argument
- Verify temp config creation
- Verify engine_settings in temp config

### Step 4: Check Unity Logs
Filter for: `[TIMESCALE-DEBUG-XXXX]`
- Check `Time.timeScale` at Start
- Check if it changes during runtime
- Compare with expected value

### Step 5: Verify Temp Config File
The script prints the temp config path. You can manually check:
```bash
cat /tmp/parkour_config_temp_XXXXX.yaml
# or on Windows:
type C:\Users\...\AppData\Local\Temp\parkour_config_temp_XXXXX.yaml
```

## Expected Behavior

1. **Python script:** Sets `time_scale` in temp config ✓
2. **ML-Agents:** Reads temp config and applies `time_scale` to Unity
3. **Unity:** `Time.timeScale` should match the config value
4. **Runtime:** Movement should be slower/faster based on time scale

## Known Issues

### Issue 1: ML-Agents Not Applying Time Scale
- **Symptom:** Temp config has correct value, but Unity `Time.timeScale` is wrong
- **Possible cause:** ML-Agents doesn't apply `time_scale` in Editor mode
- **Solution:** May need to build and run as standalone executable

### Issue 2: Unity Editor Override
- **Symptom:** `Time.timeScale` changes after ML-Agents connects
- **Possible cause:** Unity Editor settings or other scripts
- **Solution:** Check for scripts that modify `Time.timeScale`

## What to Report

When reporting issues, provide:
1. **DEBUG-ID** from the run
2. Python logs filtered by `[DEBUG-XXXX]`
3. Unity logs filtered by `[TIMESCALE-DEBUG-XXXX]`
4. The actual `Time.timeScale` value shown in Unity logs
5. Expected vs actual behavior

